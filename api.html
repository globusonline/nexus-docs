<!DOCTYPE html>
<html lang="en">
<head>
    <title>Nexus API</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="media/css/restdown.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
</head>
<body>
<div id="header">
    <h1>Nexus API Documentation</h1>
</div>

    <div id="sidebar">
<ul>
  <li><div><a href="#users">Users</a></div>
  <ul>
    <li><div><a href="#Create"><span class="method name"><span class="name">Create user</span></span></a></div></li>
    <li><div><a href="#Get"><span class="method name"><span class="name">Get a user</span></span></a></div></li>
    <li><div><a href="#Update"><span class="method name"><span class="name">Update a user profiles</span></span></a></div></li>
    <li><div><a href="#Change"><span class="method name"><span class="name">Change user password</span></span></a></div></li>
    <li><div><a href="#Delete"><span class="method name"><span class="name">Delete a user</span></span></a></div></li>
  </ul></li>
  <li><div><a href="#credentials">Credentials</a></div>
  <ul>
    <li><div><a href="#Register"><span class="method name"><span class="name">Register a ssh credential.</span></span></a></div></li>
    <li><div><a href="#Register"><span class="method name"><span class="name">Register an X.509 credential</span></span></a></div></li>
    <li><div><a href="#Register"><span class="method name"><span class="name">Register a MyProxy OAuth account credential</span></span></a></div></li>
    <li><div><a href="#Register"><span class="method name"><span class="name">Register a standard MyProxy account credential</span></span></a></div></li>
    <li><div><a href="#List"><span class="method name"><span class="name">List Credentials</span></span></a></div></li>
  </ul></li>
  <li><div><a href="#groups">Groups</a></div>
  <ul>
    <li><div><a href="#List"><span class="method name"><span class="name">List Groups</span></span></a></div></li>
  </ul></li>
  <li><div><a href="#group">Group</a></div>
  <ul>
    <li><div><a href="#List"><span class="method name"><span class="name">List group members</span></span></a></div></li>
    <li><div><a href="#Invite"><span class="method name"><span class="name">Invite member to group</span></span></a></div></li>
    <li><div><a href="#List"><span class="method name"><span class="name">List policies for group</span></span></a></div></li>
    <li><div><a href="#List"><span class="method name"><span class="name">List messages or events for a group</span></span></a></div></li>
    <li><div><a href="#List"><span class="method name"><span class="name">List email templates for a group</span></span></a></div></li>
    <li><div><a href="#Create"><span class="method name"><span class="name">Create group</span></span></a></div></li>
  </ul></li>
</ul>

    </div>
    <div id="content">

<h1>Nexus API</h1>
<div class="intro">


<p>Nexus is the service which provides user profiles, groups and other resources for GlobusOnline.
It also provides the interfaces for authentication with GlobusOnline.  All requests to globusonline are made in the context of a community.
The community name is set using the X-Go-Community-Context header.</p>

<p>So cURL requests to be executed in the context of a specific community would specify the header like:</p>

<p><code>$ curl -H 'X-Go-Community-Context: mycommunity'</code></p>

<p>If the community context is not set, the request will be made in the default GlobusOnline context.</p>

<h3>All API calls start with</h3>

<p><code>https://nexus.api.globusonline.org</code></p>

<h3>Format</h3>

<p>All responses are <strong>JSON</strong> (that is, except for the current HTML docs that you are reading).</p>


</div>
<h1 id="users">Users</h1>

<p>Manage user profiles</p>

<h2 id="Create"><span class="method name"><span class="name">Create user</span></span></h2>

<p><em>POST /users</em></p>

<p>None</p>

<h4>None</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/users -d '{
        "username": "username", 
        "accept_terms": true, 
        "opt_in": true, 
        "fullname": "Dummy Users", 
        "password": "ChangeMe", 
        "email": "no-reply@globusonline.org"
    }'
</code></pre>

<hr />

<h4>Unsuccessfully create user with duplicate username</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/users -d '{
        "username": "username", 
        "accept_terms": true, 
        "opt_in": true, 
        "fullname": "Dummy Users", 
        "password": "ChangeMe", 
        "email": "no-reply@globusonline.org"
    }'
</code></pre>

<hr />

<h2 id="Get"><span class="method name"><span class="name">Get a user</span></span></h2>

<p><em>GET /users/username</em></p>

<p>None</p>

<h4>Successfully retrieve a user</h4>

<pre><code>$ curl -X GET -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username
</code></pre>

<hr />

<h4>Request nonexistant user.</h4>

<pre><code>$ curl -X GET -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username
</code></pre>

<hr />

<h2 id="Update"><span class="method name"><span class="name">Update a user profiles</span></span></h2>

<p><em>PUT /users/username</em></p>

<p>None</p>

<h4>Successfully update a user profile.</h4>

<pre><code>$ curl -X PUT -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username -d '{
        "fullname": "New Name"
    }'
</code></pre>

<hr />

<h2 id="Change"><span class="method name"><span class="name">Change user password</span></span></h2>

<p><em>POST /users/username</em></p>

<p>None</p>

<h4>Successfully change password</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username -d '{
        "password1": "NewPassword", 
        "password2": "NewPassword", 
        "currentpassword": "ChangeMe"
    }'
</code></pre>

<hr />

<h2 id="Delete"><span class="method name"><span class="name">Delete a user</span></span></h2>

<p><em>DELETE /user/username</em></p>

<p>None</p>

<h4>Successfully delete user</h4>

<pre><code>$ curl -X DELETE -H "Content-Type: application/json" https://nexus.api.globusonline.org/user/username
</code></pre>

<hr />

<h1 id="credentials">Credentials</h1>

<p>Manage credentials associated with a user profile.</p>

<p>Current supported types are:</p>

<ul>
<li>X.509</li>
<li>MyProxy</li>
<li>MyProxy (OAuth)</li>
<li>SSH (OpenSSH format)</li>
<li>Google (OpenId)</li>
</ul>

<h2 id="Register"><span class="method name"><span class="name">Register a ssh credential.</span></span></h2>

<p><em>POST /users/username/credentials/ssh2</em></p>

<p>None</p>

<h4>Successfully create an SSH credential for a user</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username/credentials/ssh2 -d '{
        "alias": "My SSH Credential", 
        "ssh_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCfsbK35x9W3fH/bZ/AJC0mq93DC7ulCleDeQoCsYHWWbLLDtWnlkpHCjXwK1zV7ECYh2FioUs/Dw38+Cj3H+T0EG2ZZrsG6LQOOOLMnAeOic0dD5KmkqJxsMXF1q+vuI1/DKH4qv3ijELduKyqnm/TvXaed+ibrKnM+BWNb0/e2ZmvWZxlBtPC5vpn6VRXDVKbxbwK+X/VRfYyyh0UZcsPoVs99xeHOPZ8c9xCK3Gx9Djp78IWXFcEuuz29wWb/3LEwq7btvA8GC+qNDa+Sh3Co2ikvfoa8g0jVEr58aqE6IwD9NMEoIcK/rDvdoyP39mTBKqHYBQRJ+JOzX9KyViB comment"
    }'
</code></pre>

<hr />

<h2 id="Register"><span class="method name"><span class="name">Register an X.509 credential</span></span></h2>

<p><em>POST /users/username/credentials/x509</em></p>

<p>None</p>

<h4>Successfully create an X.509 credential for a user</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username/credentials/x509 -d '{
        "alias": "My X.509", 
        "certificate": "-----BEGIN CERTIFICATE-----\nMIICejCCAeOgAwIBAgIBCTANBgkqhkiG9w0BAQUFADBJMQswCQYDVQQGEwJVUzEa\nMBgGA1UEChMRR2xvYnVzIENvbnNvcnRpdW0xHjAcBgNVBAMTFUNlcnRpZmljYXRl\nIEF1dGhvcml0eTAeFw0xMTAyMjQxOTU0MjBaFw0xMjAyMjQxOTU0MjBaMEAxCzAJ\nBgNVBAYTAlVTMRowGAYDVQQKExFHbG9idXMgQ29uc29ydGl1bTEVMBMGA1UEAxMM\nSkdsb2J1cyB0ZXN0MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC/lJGJInNL\n8EtkxNpkiSzAYDHgnEdopx7t7oyzAFIZ/wUXm2EL10M3maj/RaB+9buqmcSxMBp3\nnRJT72GO0MkxAYp20MSiDmDoTOQOwj4drt1plfYgDVfGp6NZdzaYGuu9FCIp8rNA\n9r45yE71rq7C/pgZkMgk231ICtJPWCAriwIDAQABo3sweTAJBgNVHRMEAjAAMCwG\nCWCGSAGG+EIBDQQfFh1PcGVuU1NMIEdlbmVyYXRlZCBDZXJ0aWZpY2F0ZTAdBgNV\nHQ4EFgQUeyIZsiXmtX/rBWJe1q2d1YkLZYQwHwYDVR0jBBgwFoAUeLGfYCEMWUsK\nTXr/aUeO0l3bGVYwDQYJKoZIhvcNAQEFBQADgYEA0xLD3WI14KnbUkD1kag0/vFk\n/RIYVEfGQEBQRAg9u48+5VixO5yPG8YCNODMAAMfBvmVBv1cuCszlLllDxVT96VM\nL3IjT582oYzQbk1DaDvGwNmQ1RTah6o/+CSOeRZ4Jr4h2p2CaTbMF2gwg+KLx8Pc\nPHNCl/fPxmu/1EYUBHo=\n-----END CERTIFICATE-----\n"
    }'
</code></pre>

<hr />

<h2 id="Register"><span class="method name"><span class="name">Register a MyProxy OAuth account credential</span></span></h2>

<p><em>POST /users/username/credentials/oauth</em></p>

<p>This type of credential is used with a MyProxy service which exposes the OAuth protocol. This is the preferred method of working with MyProxy.  Note, that this action returns a redirct message, as opposed to a json body.  The url in the location header should be used to complete the OAuth dance.</p>

<h4>Successfuly start the OAuth Dance with a MyProxy server</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username/credentials/oauth -d '{
        "username": "username", 
        "alias": "My OAuth", 
        "server": "grid.ci.uchicago.edu"
    }'
</code></pre>

<hr />

<h2 id="Register"><span class="method name"><span class="name">Register a standard MyProxy account credential</span></span></h2>

<p><em>POST /users/username/credentials/myproxy</em></p>

<p>Standard MyProxy is not the best type of credential to use if your MyProxy server supports OAuth.  Using standard MyProxy requires the user to send their password to the Nexus service.</p>

<h4>Successfully create a MyProxy Credential</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username/credentials/myproxy -d '{
        "username": "username", 
        "alias": "My MyProxy account", 
        "password": "password", 
        "server": "grid.ci.uchicago.edu"
    }'
</code></pre>

<hr />

<h2 id="List"><span class="method name"><span class="name">List Credentials</span></span></h2>

<p><em>POST /users/username/credentials</em></p>

<p>None</p>

<h4>List credentials for user</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/users/username/credentials
</code></pre>

<hr />

<h1 id="groups">Groups</h1>

<p>Manage groups.</p>

<h2 id="List"><span class="method name"><span class="name">List Groups</span></span></h2>

<p><em>GET /groups/list</em></p>

<p>Show a list of groups.  Groups are hierarchical, i.e., groups can have child groups.  As such, a list of groups needs to have a base node and a depth.  The depth defines how many generations of groups should be retrieved.  So, a depth of 1 will return all of the child groups of the root, while a depth of 2 will return all of the children and grandchildren of the root group.</p>

<h4>Get a list of groups 1 deep</h4>

<pre><code>$ curl -X GET -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups/list?depth=1
</code></pre>

<hr />

<h1 id="group">Group</h1>

<p>Manage a specific group. The url for all groups is defined in the results of the group list.  It will follow the pattern /groups/&lt;groupid&gt; but the groupid is, at the moment, an opaque identifier.  Similarly, the urls for subresources of a group are defined by the group summary.  They will follow the same pattern of using the groupid as the identifier.</p>

<h2 id="List"><span class="method name"><span class="name">List group members</span></span></h2>

<p><em>GET /groups/&lt;groupid&gt;/members</em></p>

<p>As with the group summary</p>

<h4>Successfully retrieve the list of members in a group.</h4>

<pre><code>$ curl -X GET -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups/34951220-ad51-407d-8502-f83168834ece/members
</code></pre>

<hr />

<h2 id="Invite"><span class="method name"><span class="name">Invite member to group</span></span></h2>

<p><em>POST /groups/&lt;groupid&gt;/members</em></p>

<p>People can be invited to a group either by email address or by username.  While they will need to have a user account to join a group, an invitation can be sent to an individual without an account</p>

<h4>Invite someone to join a group via email address (Likely someone without an account)</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups/34951220-ad51-407d-8502-f83168834ece/members -d '{
        "emails": [
            "user1@no-reply.com", 
            "user2@no-reply.com"
        ]
    }'
</code></pre>

<hr />

<h4>Invite someone to join a group by username</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups/34951220-ad51-407d-8502-f83168834ece/members -d '{
        "users": [
            "user1", 
            "user2"
        ]
    }'
</code></pre>

<hr />

<h2 id="List"><span class="method name"><span class="name">List policies for group</span></span></h2>

<p><em>GET /groups/&lt;groupid&gt;/policies</em></p>

<p>Return a collection of policies for a group.  These represent "effective" policies, meaning that the policy list has been merged from parent groups.</p>

<h4>Successfully retrieve policy list</h4>

<pre><code>$ curl -X GET -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups/34951220-ad51-407d-8502-f83168834ece/policies
</code></pre>

<hr />

<h2 id="List"><span class="method name"><span class="name">List messages or events for a group</span></span></h2>

<p><em>GET /groups/&lt;groupid&gt;/messages</em></p>

<p>Events and notifications are registered for a group. For example, when a new member joins a group that has specific requirements (as defined by the policies), an administrator needs to be notified to evaluate the request. This resource will return a list of those notifications.</p>

<h4>Successfully retrieve a message list</h4>

<pre><code>$ curl -X GET -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups/34951220-ad51-407d-8502-f83168834ece/messages
</code></pre>

<hr />

<h2 id="List"><span class="method name"><span class="name">List email templates for a group</span></span></h2>

<p><em>GET /groups/&lt;groupid&gt;/email_templates</em></p>

<p>Groups have a set of associated email templates which are used to generate emails to be sent to members.  This returns a list of those templates</p>

<h4>Successfully list email templates</h4>

<pre><code>$ curl -X GET -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups/34951220-ad51-407d-8502-f83168834ece/email_templates
</code></pre>

<hr />

<h2 id="Create"><span class="method name"><span class="name">Create group</span></span></h2>

<p><em>POST /groups</em></p>

<p>Create a new group.  This can be a subgroup of another group or a root group (A group with no parent).</p>

<h4>Create a subgroup</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups -d '{
        "is_active": true, 
        "name": "My new group", 
        "parent": "34951220-ad51-407d-8502-f83168834ece", 
        "description": "This is my new sub group"
    }'
</code></pre>

<hr />

<h4>Create a new root group</h4>

<pre><code>$ curl -X POST -H "Content-Type: application/json" https://nexus.api.globusonline.org/groups -d '{
        "is_active": true, 
        "name": "New root Group", 
        "description": "Demonstrate creating a root group"
    }'
</code></pre>

<hr />

    </div>
<script type="text/javascript" charset="utf-8">
$(function() {
    var headerHeight = $("#header").height();

    var sections = $("#content h1[id], #content h2[id]");
    var sectionOffsets = [];
    var slack = 100;  // Give the section scroll some slack (in pixels).
    sections.each(function(elem) {
        sectionOffsets.push($(this).offset().top - headerHeight - slack);
    });

    var currSectionIdx = -1;
    function getSectionIdx(scrollDistance) {
        if (scrollDistance < sectionOffsets[0]) {
            return -1;
        } else {
            for (var id = sectionOffsets.length; id > 0; id--) {
                if (scrollDistance > sectionOffsets[id - 1]) {
                    return id - 1;
                    break;
                }
            }
        }
    }

    /** {{{ http://code.activestate.com/recipes/577787/ (r2) */
    _slugify_strip_re = /[^\w\s-]/g;
    _slugify_hyphenate_re = /[-\s]+/g;
    function slugify(s) {
      s = s.replace(_slugify_strip_re, '').trim().toLowerCase();
      s = s.replace(_slugify_hyphenate_re, '-');
      return s;
    }
    /** end of http://code.activestate.com/recipes/577787/ }}} */

    /* See <https://github.com/trentm/restdown/issues/11>. */
    function safechars(s) {
      return s.replace(_slugify_strip_re, '');
    }

    $("#content").scroll(function() {
        var scrollDistance = $("#content").scrollTop();
        var sectionIdx = getSectionIdx(scrollDistance);

        if (sectionIdx !== currSectionIdx) {
            $("#sidebar li>div").removeClass("current");
            currSectionIdx = sectionIdx;
            if (currSectionIdx >= 0) {
                var heading = $(sections[currSectionIdx]).text();
                var possibleAnchors = [
                    slugify(heading), // h1 or non-method h2
                    heading.replace(/ /g, '-'), // h2 method, just name or just endpoint
                    heading.slice(0, heading.lastIndexOf(' (')).trimRight().replace(/ /g, '-'), // h2 method, name and endpoint
                ];
                for (var i=0; i < possibleAnchors.length; i++) {
                    var anchor = safechars(possibleAnchors[i]);
                    try {
                        $("#sidebar a[href=#" + anchor + "]").parent().addClass("current");
                    } catch (e) {
                        /* Ignore error if no such element. */
                        console.log(e)
                    }
                }
            }
        }
    });
});
</script>

</body>
</html>
